<MudDialog>
    <TitleContent>Create Vault</TitleContent>
    <DialogContent>
        <MudTextField Label="Vault Name" @bind-Value="VaultName" Required="true" />
        <MudTextField Label="Password" @bind-Value="Password" InputType="InputType.Password" Required="true" />
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Save" Color="Color.Primary" Variant="Variant.Filled">Save</MudButton>
        <MudButton OnClick="Cancel" Color="Color.Secondary" Variant="Variant.Outlined">Cancel</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] IMudDialogInstance MudDialog { get; set; } = default!;
    [Inject] private VaultService VaultService { get; set; } = default!;
    [Parameter] public EventCallback<VaultService.Vault> OnSave { get; set; }

    private string VaultName { get; set; } = string.Empty;
    private string Password { get; set; } = string.Empty;

    private async Task Save()
    {
        if (string.IsNullOrWhiteSpace(VaultName) || string.IsNullOrWhiteSpace(Password))
            return;

        // Appel direct au service pour créer le vault
        var createdVault = await VaultService.CreateVaultAsync(VaultName, Password);

        // Notifie la page par callback
        await OnSave.InvokeAsync(createdVault);

        MudDialog.Close();
    }

    private void Cancel()
    {
        MudDialog.Cancel();
    }
}
